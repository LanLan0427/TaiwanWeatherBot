# TaiwanWeatherBot (Discord/Line æ°£è±¡ & å¤©æ–‡æ©Ÿå™¨äºº)

é€™å€‹å°ˆæ¡ˆåŒ…å«å…©å€‹è‡ªå‹•åŒ–æ©Ÿå™¨äººï¼š**æ¯æ—¥æ°£è±¡å»£æ’­**èˆ‡**NASA å¤©æ–‡æ¯æ—¥ä¸€åœ– (APOD)**ã€‚å®ƒå€‘æœƒå®šæ™‚æŠ“å–è³‡æ–™ï¼Œä¸¦é€é **Google Gemini AI** ç”Ÿæˆç”Ÿå‹•æœ‰è¶£çš„è§£èªªï¼Œæœ€å¾Œç™¼é€åˆ° **Discord/Line** é »é“ã€‚

> **æœ€æ–°åŠŸèƒ½ (v2.0)**ï¼š
> 1. å…¨é¢å‡ç´š **Line Flex Message**ï¼Œæä¾›ç²¾ç¾åœ–æ–‡å¡ç‰‡ä»‹é¢ï¼
> 2. æ”¯æ´ **Google Apps Script å…¨è‡ªå‹•è¨‚é–±**ï¼Œæ©Ÿå™¨äººåŠ å…¥ç¾¤çµ„å³è‡ªå‹•ç”Ÿæ•ˆã€‚

## âœ¨ åŠŸèƒ½ç‰¹è‰²

### ğŸŒ¤ï¸ å°ç£æ°£è±¡æ©Ÿå™¨äºº (`weather_bot.py`)
- **è³‡æ–™ä¾†æº**ï¼šä¸­å¤®æ°£è±¡ç½² (CWA) é–‹æ”¾è³‡æ–™å¹³å°ã€‚
- **åŠŸèƒ½**ï¼š
  - æŠ“å–å…¨å°å„ç¸£å¸‚æœªä¾† 12 å°æ™‚çš„å¤©æ°£é å ±ï¼ˆæ°£æº«ã€é™é›¨æ©Ÿç‡ã€å¤©æ°£ç¾è±¡ï¼‰ã€‚
  - å°‡ç¸£å¸‚åˆ†ç‚ºåŒ—ã€ä¸­ã€å—ã€æ±ã€å¤–å³¶äº”å¤§å€å¡Šæ•´ç†é¡¯ç¤ºã€‚
  - **AI é»è©•**ï¼šä½¿ç”¨ Gemini AI æ‰®æ¼”ã€Œå¹½é»˜æ°£è±¡æ’­å ±å“¡ã€ï¼Œæä¾›ä»Šæ—¥é‡é»ã€å¤©æ°£è§€å¯Ÿèˆ‡ç©¿æ­å»ºè­°ã€‚
- **ç™¼é€æ–¹å¼**ï¼š
  - **Line**ï¼šç²¾ç¾ Flex Message å¡ç‰‡ï¼Œä¾é™é›¨æ©Ÿç‡é¡¯ç¤ºä¸åŒé¡è‰²åœ–ç¤ºã€‚
  - **Discord**ï¼šRich Embed æ ¼å¼ã€‚

### ğŸŒŒ NASA å¤©æ–‡æ©Ÿå™¨äºº (`nasa_bot.py`)
- **è³‡æ–™ä¾†æº**ï¼šNASA APOD API (è‹¥ API å¤±æ•—æœƒè‡ªå‹•åˆ‡æ›ç‚ºç¶²é çˆ¬èŸ²æ¨¡å¼)ã€‚
- **åŠŸèƒ½**ï¼š
  - æŠ“å–æ¯æ—¥ä¸€å¼µå¤©æ–‡ç²¾é¸åœ–ç‰‡ (Image of the Day)ã€‚
  - **AI è§£èªª**ï¼šä½¿ç”¨ Gemini AI ç”Ÿæˆå…©æ®µå…§å®¹ï¼š
    - **ğŸ“– å®‡å®™æ—¥è¨˜**ï¼šæ„Ÿæ€§çš„ç¬¬ä¸€äººç¨±çŸ­æ–‡ã€‚
    - **ğŸ”­ å¤©æ–‡ç§‘æ™®**ï¼šç™½è©±æ–‡è§£é‡‹å¤©æ–‡ç¾è±¡ã€‚
  - å…·å‚™å¼·å¤§çš„å®¹éŒ¯æ©Ÿåˆ¶ (API é‡è©¦ã€çˆ¬èŸ²å‚™æ´)ã€‚
- **ç™¼é€æ–¹å¼**ï¼š
  - **Line**ï¼šæ²‰æµ¸å¼å®‡å®™é¢¨æ ¼å¡ç‰‡ï¼Œæ”¯æ´ä¸€éµä¸‹è¼‰é«˜æ¸…å¤§åœ–ã€‚
  - **Discord**ï¼šRich Embed æ ¼å¼ã€‚

---

## ğŸ› ï¸ å®‰è£èˆ‡è¨­å®š

### 1. ç’°å¢ƒéœ€æ±‚
- Python 3.11 æˆ–ä»¥ä¸Š
- å»ºè­°ä½¿ç”¨è™›æ“¬ç’°å¢ƒ

### 2. å®‰è£å¥—ä»¶
è«‹åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å®‰è£æ‰€éœ€å¥—ä»¶ï¼š
```bash
pip install -r requirements.txt
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸ (Secrets)
æœ¬å°ˆæ¡ˆä¾è³´ç’°å¢ƒè®Šæ•¸ä¾†ç®¡ç†é‡‘é‘°ã€‚

#### ğŸ”¹ GitHub Actions
è«‹åœ¨ **Settings -> Secrets and variables -> Actions** ä¸­è¨­å®š Repository Secretsã€‚

#### ğŸ”¹ æœ¬æ©Ÿé–‹ç™¼ (.env)
æœ¬å°ˆæ¡ˆæ”¯æ´ `.env` æª”æ¡ˆã€‚è«‹è¤‡è£½ `.env.example` ä¸¦é‡æ–°å‘½åç‚º `.env`ï¼Œç„¶å¾Œå¡«å…¥æ‚¨çš„é‡‘é‘° (æ­¤æª”æ¡ˆå·²å¿½ç•¥ï¼Œä¸æœƒä¸Šå‚³)ã€‚
```bash
cp .env.example .env
```

| è®Šæ•¸åç¨± | èªªæ˜ | å¿…å¡« | å–å¾—æ–¹å¼ |
| :--- | :--- | :--- | :--- |
| `WEBHOOK_URL` | Discord Webhook ç¶²å€ | âœ… | Discord é »é“è¨­å®š -> æ•´åˆ -> Webhook |
| `GEMINI_API_KEY` | Google Gemini API Key | âœ… | [Google AI Studio](https://aistudio.google.com/) |
| `CWA_API_KEY` | ä¸­å¤®æ°£è±¡ç½² API Key | âœ… | [æ°£è±¡è³‡æ–™é–‹æ”¾å¹³å°](https://opendata.cwa.gov.tw/) |
| `NASA_API_KEY` | NASA API Key | ğŸŸ¡ | [NASA APIs](https://api.nasa.gov/) (å»ºè­°ç”³è«‹ï¼Œé›–æœ‰ DEMO_KEY ä½†é™åˆ¶å¤š) |
| `LINE_TOKEN` | Line Channel Access Token | ğŸŸ¡ | [Line Developers Console](https://developers.line.biz/) (å•Ÿç”¨ Line é€šçŸ¥å¿…å¡«) |
| `SUBSCRIBER_API_URL` | è‡ªå‹•è¨‚é–± API (GAS) | âœ… | **å¿…å¡«**ï¼Œé€é Google Apps Script å¯¦ä½œè‡ªå‹•è¨‚é–±åŠŸèƒ½ (è©³è¦‹ `walkthrough_gas.md`) |

> **âš ï¸ æ³¨æ„**ï¼šæœ¬å°ˆæ¡ˆå·²ç§»é™¤æ‰‹å‹•è¨­å®š `LINE_USER_ID` çš„æ–¹å¼ï¼Œè«‹å‹™å¿…éƒ¨ç½² GAS è…³æœ¬ä¾†å•Ÿç”¨è‡ªå‹•è¨‚é–±åŠŸèƒ½ã€‚

---

## ğŸ¤– è‡ªå‹•è¨‚é–±ç³»çµ± (Auto-Subscribe)

æœ¬å°ˆæ¡ˆæ¡ç”¨ **Google Apps Script (GAS)** ä½œç‚ºä¸­ä»‹å±¤ï¼Œå¯¦ç¾ã€Œéš¨åŠ éš¨ç”¨ã€çš„é«”é©—ï¼š
1. åƒè€ƒ `walkthrough_gas.md` éƒ¨ç½² GAS è…³æœ¬ã€‚
2. å°‡ç”Ÿæˆçš„ Webhook URL å¡«å…¥ Line Developers Consoleã€‚
3. å°‡ GAS æ‡‰ç”¨ç¨‹å¼ç¶²å€å¡«å…¥ `.env` çš„ `SUBSCRIBER_API_URL`ã€‚
4. **å®Œæˆï¼** ä¹‹å¾Œåªè¦æŠŠæ©Ÿå™¨äººåŠ å…¥ä»»ä½•ç¾¤çµ„ï¼Œè©²ç¾¤çµ„å°±æœƒè‡ªå‹•æ”¶åˆ°éš”å¤©çš„å»£æ’­ã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æœ¬æ©ŸåŸ·è¡Œ
ç¢ºä¿ç’°å¢ƒè®Šæ•¸å·²è¨­å®šå¾Œï¼Œå¯ç›´æ¥åŸ·è¡Œ Python è…³æœ¬ï¼š

**åŸ·è¡Œæ°£è±¡æ©Ÿå™¨äººï¼š**
```bash
python weather_bot.py
```

**åŸ·è¡Œ NASA æ©Ÿå™¨äººï¼š**
```bash
python nasa_bot.py
```

### GitHub Actions è‡ªå‹•åŒ–
æœ¬å°ˆæ¡ˆå·²åŒ…å« GitHub Actions è¨­å®šæª”ï¼š
- **æ°£è±¡å»£æ’­** (`WeatherBot.yml`)ï¼šé è¨­ç‚º**æ¯å¤©å°ç£æ™‚é–“ 06:00 (UTC 22:00)** è‡ªå‹•åŸ·è¡Œã€‚
- **NASA å®‡å®™æ—¥è¨˜** (`nasa.yml`)ï¼šé è¨­ç‚º**æ¯å¤©å°ç£æ™‚é–“ 22:00 (UTC 14:00)** è‡ªå‹•åŸ·è¡Œã€‚

> [!TIP]
> **é è¨­ç‚ºåœç”¨ç‹€æ…‹**ï¼šç‚ºäº†é¿å…èˆ‡æ‚¨çš„ç§æœ‰å°ˆæ¡ˆé‡è¤‡åŸ·è¡Œï¼Œæ­¤å„²å­˜åº«çš„è‡ªå‹•æ’ç¨‹é è¨­ç‚º**è¨»è§£ (Disabled)** ç‹€æ…‹ã€‚
> è‹¥æ‚¨ Fork æœ¬å°ˆæ¡ˆä¸¦å¸Œæœ›å•Ÿç”¨è‡ªå‹•å»£æ’­ï¼Œè«‹ç·¨è¼¯ `.github/workflows/*.yml` æª”æ¡ˆï¼Œå°‡ `schedule` å€å¡Šçš„è¨»è§£ (`#`) ç§»é™¤å³å¯ã€‚

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹
```
TaiwanWeatherBot/
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ WeatherBot.yml    # å°ç£æ°£è±¡å»£æ’­æ’ç¨‹
â”‚   â””â”€â”€ nasa.yml          # NASA å®‡å®™æ—¥è¨˜æ’ç¨‹
â”œâ”€â”€ weather_bot.py        # æ°£è±¡æ©Ÿå™¨äººä¸»ç¨‹å¼ (å« Flex Message ç”Ÿæˆ)
â”œâ”€â”€ nasa_bot.py           # NASA æ©Ÿå™¨äººä¸»ç¨‹å¼ (å« Flex Message ç”Ÿæˆ)
â”œâ”€â”€ walkthrough_gas.md    # GAS è‡ªå‹•è¨‚é–±éƒ¨ç½²æ•™å­¸
â”œâ”€â”€ requirements.txt      # Python å¥—ä»¶æ¸…å–®
â”œâ”€â”€ .gitignore            # Git å¿½ç•¥æ¸…å–®
â”œâ”€â”€ LICENSE               # æˆæ¬Šæ–‡ä»¶
â””â”€â”€ README.md             # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶

```

---

## ğŸ¤ å¦‚ä½•è²¢ç» (Contributing)
æ­¡è¿æäº¤ Issue æˆ– Pull Request ä¾†æ”¹é€²é€™å€‹å°ˆæ¡ˆï¼

1. Fork é€™å€‹å°ˆæ¡ˆ
2. å»ºç«‹æ‚¨çš„ Feature Branch (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ‚¨çš„è®Šæ›´ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ° Branch (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“ æˆæ¬Š (License)
æœ¬å°ˆæ¡ˆæ¡ç”¨ [MIT License](LICENSE) æˆæ¬Šã€‚
